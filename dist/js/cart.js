"use strict";require(["config"],function(){require(["jquery","jqcookie"],function(){$.ajax({url:"http://10.31.155.38/test/yohoo_fake/php/rqdp_conn.php",dataType:"json"}).done(function(s){var n=$.cookie("cookieid"),a="";n=n.split(","),$.each(n,function(c,t){var i=$.cookie("cookiecount").split(",")[c];$.each(s,function(t,e){s[t].sid==n[c]&&(a+='<li class="clearfix goods_li"sid="'+n[c]+'" >\n                        <div class="pay-pro td " style="width: 368px;margin-left: 60px;position:relative">\n                        <i class=" iconfontselect cart-item-checked singleselect" ></i>\n                            <a class="pay-pro-icon" href="javascript:;" target="_blank">\n                                <img src="'+e.url+'" style="width: 64px;height:85px;">\n                            </a>\n                            <div class="pay-pro-info">\n                                <a class="info_dsb" href="javascript:;" target="_blank" >\n                                    '+e.title+'\n                                </a>\n                                <em class="pay-pro-detail">\n                                    <span>\n                                        <b title="">颜色：'+e.color.split(",")[0]+"</b>\n                                        尺码："+e.size.split(",")[0]+'<i class="iconfont1" style="font-size: 14px;"></i>\n                                    </span>\n                                </em>\n                            </div>\n                        </div>\n                        <div class="product-price td " style="width:148px;">\n                            <p class="p-product-price p-product-price'+c+'">¥'+e.price+'</p>\n                        </div>\n                        \x3c!-- 数量 --\x3e\n                        <div class="num-wraper">\n                            <span class="minus-plus pull-left">\n                                <i  class="iconfont1 minus-num" style="font-size: 12px;line-height: 26px;"></i>\n                            </span>\n                            <span  class="num num'+c+' pull-left">'+i+'</span>\n                            <span class="minus-plus pull-left">\n                                <i  class="iconfont1 plus-num" style="font-size: 12px;line-height: 24px;"></i>\n                            </span>\n                        </div>\n                        \x3c!-- 小计 --\x3e\n                        <div style="width:160px;margin-top: 32px;" class="sub-total td sub-total'+c+'">\n                            ¥'+e.price*i+'\n                        </div>\n                        \x3c!-- 操作 --\x3e\n                        <div style="width:100px;margin-top: 22px;" class="cart-operation td">\n                            <span class="cart-del-btn cart-del-btn'+c+'">删除</span>\n                            <span class="cart-col-btn">移入收藏</span>\n                        </div>\n                    </div>\n                    </li>\n                            ')})}),$(".promotion-pool .cart-table .goods_ul").html(a);var t=e();function e(){var c=0;return $.each($(".singleselect"),function(t,e){-1!=$(this).prop("className").indexOf("cart-item-checked")&&c++}),c}$(".allselect").on("click",function(){-1!=$(this).prop("className").indexOf("cart-item-checked")?($(this).removeClass("cart-item-checked").addClass("cart-item-check"),$.each($(".singleselect"),function(t,e){$(this).removeClass("cart-item-checked").addClass("cart-item-check")})):($(this).removeClass("cart-item-check").addClass("cart-item-checked"),$.each($(".singleselect"),function(t,e){$(this).removeClass("cart-item-check").addClass("cart-item-checked")})),t=e(),$(".ins").text(t)});var c=0;$(".singleselect").on("click",function(){-1!=$(this).prop("className").indexOf("cart-item-checked")?($(this).removeClass("cart-item-checked").addClass("cart-item-check"),$(".allselect").removeClass("cart-item-checked").addClass("cart-item-check")):($(this).removeClass("cart-item-check").addClass("cart-item-checked"),c=0,$.each($(".singleselect"),function(t,e){-1!=$(this).prop("className").indexOf("cart-item-checked")&&c++,c==$(".singleselect").size()&&$(".allselect").removeClass("cart-item-check").addClass("cart-item-checked")})),t=e(),$(".ins").text(t)}),$(".ins").text(t);var i=null,l=null;$(".plus-num").each(function(t){$(this).on("click",function(){var e=0;i=$(".num"+t).text(),i++,$(".num"+t).text(i),$(".sub-total"+t).text("￥"+parseInt($(".p-product-price"+t).text().slice(1))*i),$(".sub-total").each(function(t){e+=parseInt($(this).text().trim().slice(1))}),$(".sum").find("strong").text("￥"+e)})}),$(".minus-num").each(function(t){$(this).on("click",function(){var e=0;l=$(".num"+t).text(),0==--l&&(l=1),$(".num"+t).text(l),$(".sub-total"+t).text("￥"+parseInt($(".p-product-price"+t).text().slice(1))*l),$(".sub-total").each(function(t){e+=parseInt($(this).text().trim().slice(1))}),$(".sum").find("strong").text("￥"+e)})});var o=0;$(".sub-total").each(function(t){o+=parseInt($(this).text().trim().slice(1))}),$(".sum").find("strong").text("￥"+o),$(".cart-del-btn").each(function(c){$(this).on("click",function(){console.log(c),$(".cart-del-btn"+c).parent().parent().detach();var t=$.cookie("cookieid").split(","),e=$.cookie("cookiecount").split(",");t.splice(c,1),e.splice(c,1),$.cookie("cookieid","",{expires:-1}),$.cookie("cookiecount","",{expires:-1}),$.cookie("cookieid",t.toString(),{expires:7}),$.cookie("cookiecount",e.toString(),{expires:7})})})})})});